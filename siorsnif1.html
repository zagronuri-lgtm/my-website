<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>×˜×•×¤×¡ ×¡×™×•×¨ ×¡× ×™×£ | ×¦'×§ ×œ×™×¡×˜ ×¡×× ×›"×œ×™×</title>
    <link href="https://fonts.googleapis.com/css2?family=Heebo:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-primary: #fafbfc;
            --bg-card: #ffffff;
            --bg-section: #f8f9fa;
            --accent-primary: #0066ff;
            --accent-secondary: #00c853;
            --accent-warning: #ff9800;
            --accent-danger: #f44336;
            --text-primary: #1a1a2e;
            --text-secondary: #64748b;
            --text-muted: #94a3b8;
            --border-color: #e2e8f0;
            --border-focus: #0066ff;
            --shadow-sm: 0 1px 2px rgba(0,0,0,0.05);
            --shadow-md: 0 4px 12px rgba(0,0,0,0.08);
            --shadow-lg: 0 8px 24px rgba(0,0,0,0.12);
            --radius-sm: 8px;
            --radius-md: 12px;
            --radius-lg: 16px;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: 'Heebo', sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            line-height: 1.6;
            min-height: 100vh;
        }

        /* Header */
        .header {
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            color: white;
            padding: 1.5rem;
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: var(--shadow-lg);
        }

        .header-content {
            max-width: 900px;
            margin: 0 auto;
        }

        .header h1 {
            font-size: 1.5rem;
            font-weight: 800;
            margin-bottom: 0.25rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .header-meta {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
            margin-top: 1rem;
        }

        .header-input {
            flex: 1;
            min-width: 150px;
        }

        .header-input label {
            display: block;
            font-size: 0.75rem;
            opacity: 0.8;
            margin-bottom: 0.25rem;
        }

        .header-input input, .header-input select {
            width: 100%;
            padding: 0.5rem 0.75rem;
            border: 1px solid rgba(255,255,255,0.2);
            border-radius: var(--radius-sm);
            background: rgba(255,255,255,0.1);
            color: white;
            font-family: inherit;
            font-size: 0.9rem;
        }

        .header-input input::placeholder {
            color: rgba(255,255,255,0.5);
        }

        .header-input input:focus, .header-input select:focus {
            outline: none;
            border-color: var(--accent-primary);
            background: rgba(255,255,255,0.15);
        }

        /* Container */
        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 1rem;
        }

        /* Navigation */
        .nav-tabs {
            display: flex;
            gap: 0.5rem;
            overflow-x: auto;
            padding: 1rem 0;
            margin-bottom: 1rem;
            -webkit-overflow-scrolling: touch;
        }

        .nav-tab {
            display: flex;
            align-items: center;
            gap: 0.4rem;
            padding: 0.6rem 1rem;
            background: var(--bg-card);
            border: 2px solid var(--border-color);
            border-radius: 50px;
            cursor: pointer;
            font-size: 0.85rem;
            font-weight: 600;
            white-space: nowrap;
            transition: all 0.2s ease;
        }

        .nav-tab:hover {
            border-color: var(--accent-primary);
            background: #f0f7ff;
        }

        .nav-tab.active {
            background: var(--accent-primary);
            border-color: var(--accent-primary);
            color: white;
        }

        .nav-tab .badge {
            background: rgba(0,0,0,0.1);
            padding: 0.1rem 0.4rem;
            border-radius: 10px;
            font-size: 0.7rem;
        }

        .nav-tab.active .badge {
            background: rgba(255,255,255,0.2);
        }

        .nav-tab.has-content {
            border-color: var(--accent-secondary);
        }

        .nav-tab.has-content::after {
            content: '';
            width: 8px;
            height: 8px;
            background: var(--accent-secondary);
            border-radius: 50%;
        }

        /* Section */
        .section {
            display: none;
            animation: fadeIn 0.3s ease;
        }

        .section.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .section-header {
            background: var(--bg-card);
            border-radius: var(--radius-lg);
            padding: 1.25rem;
            margin-bottom: 1rem;
            border: 1px solid var(--border-color);
            box-shadow: var(--shadow-sm);
        }

        .section-header h2 {
            font-size: 1.25rem;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 0.5rem;
        }

        .section-header p {
            color: var(--text-secondary);
            font-size: 0.85rem;
        }

        /* Question Card */
        .question-card {
            background: var(--bg-card);
            border-radius: var(--radius-lg);
            padding: 1.25rem;
            margin-bottom: 1rem;
            border: 1px solid var(--border-color);
            box-shadow: var(--shadow-sm);
            transition: all 0.2s ease;
        }

        .question-card:hover {
            box-shadow: var(--shadow-md);
        }

        .question-card.has-content {
            border-right: 4px solid var(--accent-secondary);
        }

        .question-title {
            font-weight: 600;
            font-size: 0.95rem;
            margin-bottom: 0.5rem;
            display: flex;
            align-items: flex-start;
            gap: 0.5rem;
        }

        .question-title .icon {
            font-size: 1.1rem;
        }

        .guiding-questions {
            background: var(--bg-section);
            border-radius: var(--radius-sm);
            padding: 0.75rem;
            margin-bottom: 0.75rem;
            font-size: 0.8rem;
            color: var(--text-secondary);
        }

        .guiding-questions strong {
            color: var(--text-primary);
            display: block;
            margin-bottom: 0.3rem;
        }

        .guiding-questions ul {
            margin: 0;
            padding-right: 1.2rem;
        }

        .guiding-questions li {
            margin-bottom: 0.2rem;
        }

        /* Form Elements */
        textarea {
            width: 100%;
            min-height: 100px;
            padding: 0.75rem;
            border: 1px solid var(--border-color);
            border-radius: var(--radius-sm);
            font-family: inherit;
            font-size: 0.9rem;
            resize: vertical;
            transition: border-color 0.2s;
        }

        textarea:focus {
            outline: none;
            border-color: var(--border-focus);
            box-shadow: 0 0 0 3px rgba(0,102,255,0.1);
        }

        textarea::placeholder {
            color: var(--text-muted);
        }

        /* Media Upload */
        .media-upload {
            margin-top: 0.75rem;
        }

        .upload-zone {
            border: 2px dashed var(--border-color);
            border-radius: var(--radius-sm);
            padding: 1rem;
            text-align: center;
            cursor: pointer;
            transition: all 0.2s;
        }

        .upload-zone:hover {
            border-color: var(--accent-primary);
            background: #f0f7ff;
        }

        .upload-zone input {
            display: none;
        }

        .upload-zone .icon {
            font-size: 1.5rem;
            margin-bottom: 0.25rem;
        }

        .upload-zone p {
            font-size: 0.8rem;
            color: var(--text-secondary);
        }

        .media-preview {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            margin-top: 0.75rem;
        }

        .media-item {
            position: relative;
            width: 80px;
            height: 80px;
            border-radius: var(--radius-sm);
            overflow: hidden;
            border: 1px solid var(--border-color);
        }

        .media-item img, .media-item video {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .media-item .remove-btn {
            position: absolute;
            top: 4px;
            left: 4px;
            width: 20px;
            height: 20px;
            background: var(--accent-danger);
            color: white;
            border: none;
            border-radius: 50%;
            cursor: pointer;
            font-size: 0.7rem;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* Action Items */
        .action-items-section {
            background: var(--bg-card);
            border-radius: var(--radius-lg);
            padding: 1.25rem;
            margin-top: 1.5rem;
            border: 1px solid var(--border-color);
            box-shadow: var(--shadow-sm);
        }

        .action-items-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .action-items-header h3 {
            font-size: 1.1rem;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .btn {
            display: inline-flex;
            align-items: center;
            gap: 0.4rem;
            padding: 0.5rem 1rem;
            border-radius: var(--radius-sm);
            font-family: inherit;
            font-size: 0.85rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            border: none;
        }

        .btn-primary {
            background: var(--accent-primary);
            color: white;
        }

        .btn-primary:hover {
            background: #0052cc;
            transform: translateY(-1px);
        }

        .btn-secondary {
            background: var(--bg-section);
            color: var(--text-primary);
            border: 1px solid var(--border-color);
        }

        .btn-secondary:hover {
            background: var(--border-color);
        }

        .btn-success {
            background: var(--accent-secondary);
            color: white;
        }

        .btn-success:hover {
            background: #00a344;
        }

        .btn-danger {
            background: var(--accent-danger);
            color: white;
        }

        .btn-danger:hover {
            background: #d32f2f;
        }

        .btn-word {
            background: #2b579a;
            color: white;
        }

        .btn-word:hover {
            background: #1e3f6f;
        }

        .btn-excel {
            background: #217346;
            color: white;
        }

        .btn-excel:hover {
            background: #185c37;
        }

        .action-item {
            background: var(--bg-section);
            border-radius: var(--radius-sm);
            padding: 1rem;
            margin-bottom: 0.75rem;
            border: 1px solid var(--border-color);
        }

        .action-item-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 0.75rem;
        }

        .action-item-number {
            background: var(--accent-primary);
            color: white;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.75rem;
            font-weight: 700;
        }

        .action-item-remove {
            background: none;
            border: none;
            color: var(--accent-danger);
            cursor: pointer;
            font-size: 1rem;
        }

        .action-item-fields {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 0.75rem;
        }

        .action-item-fields .full-width {
            grid-column: 1 / -1;
        }

        .field-group label {
            display: block;
            font-size: 0.75rem;
            font-weight: 600;
            color: var(--text-secondary);
            margin-bottom: 0.25rem;
        }

        .field-group input, .field-group select {
            width: 100%;
            padding: 0.5rem 0.75rem;
            border: 1px solid var(--border-color);
            border-radius: var(--radius-sm);
            font-family: inherit;
            font-size: 0.85rem;
        }

        .field-group input:focus, .field-group select:focus {
            outline: none;
            border-color: var(--border-focus);
        }

        .priority-select {
            display: flex;
            gap: 0.5rem;
        }

        .priority-option {
            flex: 1;
            padding: 0.4rem;
            border: 2px solid var(--border-color);
            border-radius: var(--radius-sm);
            text-align: center;
            cursor: pointer;
            font-size: 0.75rem;
            font-weight: 600;
            transition: all 0.2s;
        }

        .priority-option:hover {
            border-color: var(--text-secondary);
        }

        .priority-option.selected.high {
            background: #fee2e2;
            border-color: var(--accent-danger);
            color: var(--accent-danger);
        }

        .priority-option.selected.medium {
            background: #fef3c7;
            border-color: var(--accent-warning);
            color: #b45309;
        }

        .priority-option.selected.low {
            background: #dcfce7;
            border-color: var(--accent-secondary);
            color: #166534;
        }

        /* Summary Section */
        .summary-section {
            background: var(--bg-card);
            border-radius: var(--radius-lg);
            padding: 1.25rem;
            margin-top: 1rem;
            border: 1px solid var(--border-color);
            box-shadow: var(--shadow-sm);
        }

        .summary-section h3 {
            font-size: 1.1rem;
            font-weight: 700;
            margin-bottom: 0.75rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .summary-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
            gap: 0.75rem;
            margin-bottom: 1rem;
        }

        .stat-item {
            text-align: center;
            padding: 0.75rem;
            background: var(--bg-section);
            border-radius: var(--radius-sm);
        }

        .stat-value {
            font-size: 1.5rem;
            font-weight: 800;
            color: var(--accent-primary);
        }

        .stat-label {
            font-size: 0.75rem;
            color: var(--text-secondary);
        }

        /* Export Buttons */
        .export-buttons {
            display: flex;
            gap: 0.75rem;
            flex-wrap: wrap;
            margin-top: 1.5rem;
            padding-top: 1rem;
            border-top: 1px solid var(--border-color);
        }

        /* Footer */
        .footer {
            text-align: center;
            padding: 2rem 1rem;
            color: var(--text-secondary);
            font-size: 0.8rem;
        }

        /* Empty State */
        .empty-actions {
            text-align: center;
            padding: 2rem;
            color: var(--text-muted);
        }

        .empty-actions .icon {
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
        }

        /* Toast Notification */
        .toast {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%) translateY(100px);
            background: var(--text-primary);
            color: white;
            padding: 0.75rem 1.5rem;
            border-radius: var(--radius-md);
            font-size: 0.9rem;
            font-weight: 500;
            box-shadow: var(--shadow-lg);
            opacity: 0;
            transition: all 0.3s ease;
            z-index: 1000;
        }

        .toast.show {
            opacity: 1;
            transform: translateX(-50%) translateY(0);
        }

        /* Loading Overlay */
        .loading-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 9999;
            justify-content: center;
            align-items: center;
        }

        .loading-overlay.show {
            display: flex;
        }

        .loading-box {
            background: white;
            padding: 2rem;
            border-radius: var(--radius-lg);
            text-align: center;
        }

        .spinner {
            width: 50px;
            height: 50px;
            border: 4px solid var(--border-color);
            border-top-color: var(--accent-primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 1rem;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Mobile Responsive */
        @media (max-width: 600px) {
            .header h1 {
                font-size: 1.25rem;
            }

            .header-meta {
                flex-direction: column;
            }

            .action-item-fields {
                grid-template-columns: 1fr;
            }

            .export-buttons {
                flex-direction: column;
            }

            .export-buttons .btn {
                width: 100%;
                justify-content: center;
            }
        }

        /* Print Styles */
        @media print {
            .header { position: relative; }
            .nav-tabs, .upload-zone, .btn, .action-item-remove { display: none; }
            .section { display: block !important; page-break-inside: avoid; }
            .question-card { break-inside: avoid; }
        }
    </style>
</head>
<body>
    <!-- Loading Overlay -->
    <div class="loading-overlay" id="loadingOverlay">
        <div class="loading-box">
            <div class="spinner"></div>
            <div id="loadingText">××™×™×¦×...</div>
        </div>
    </div>

    <header class="header">
        <div class="header-content">
            <h1>ğŸ“‹ ×˜×•×¤×¡ ×¡×™×•×¨ ×¡× ×™×£</h1>
            <p style="opacity: 0.8; font-size: 0.85rem;">×¦'×§ ×œ×™×¡×˜ ×œ×¡×× ×›"×œ×™× - ×ª×™×¢×•×“ ×××¦××™× ×•×”××œ×¦×•×ª</p>
            
            <div class="header-meta">
                <div class="header-input">
                    <label>×©× ×”×¡× ×™×£</label>
                    <input type="text" id="branchName" placeholder="×œ×“×•×’××”: ×©×¨×•×Ÿ ×‘×™× ×¢×™×¨×•× ×™">
                </div>
                <div class="header-input">
                    <label>×ª××¨×™×š ×¡×™×•×¨</label>
                    <input type="date" id="visitDate">
                </div>
                <div class="header-input">
                    <label>×©× ×”×¡×™×™×¨</label>
                    <input type="text" id="visitorName" placeholder="×©× ××œ×">
                </div>
                <div class="header-input">
                    <label>×× ×”×œ ×”×¡× ×™×£</label>
                    <input type="text" id="branchManager" placeholder="×©× ×× ×”×œ ×”×¡× ×™×£">
                </div>
            </div>
        </div>
    </header>

    <div class="container">
        <!-- Navigation Tabs -->
        <nav class="nav-tabs" id="navTabs">
            <div class="nav-tab active" data-section="manager">ğŸ‘” ×× ×”×œ ×¡× ×™×£</div>
            <div class="nav-tab" data-section="dispatchers">ğŸ‘· ×¡×“×¨× ×™×/×©×‘×¥</div>
            <div class="nav-tab" data-section="drivers">ğŸšŒ × ×”×’×™×</div>
            <div class="nav-tab" data-section="parking">ğŸ…¿ï¸ ×—× ×™×•×Ÿ</div>
            <div class="nav-tab" data-section="taxis">ğŸš ××•× ×™×•×ª</div>
            <div class="nav-tab" data-section="tech">ğŸ’» ×˜×›× ×•×œ×•×’×™×”</div>
            <div class="nav-tab" data-section="garage">ğŸ”§ ××•×¡×›×™×</div>
            <div class="nav-tab" data-section="planning">ğŸ“Š ×ª×›× ×•×Ÿ</div>
            <div class="nav-tab" data-section="summary">ğŸ“ ×¡×™×›×•×</div>
        </nav>

        <!-- Section: ×× ×”×œ ×¡× ×™×£ -->
        <div class="section active" id="section-manager">
            <div class="section-header">
                <h2>ğŸ‘” ×©×™×—×” ×¢× ×× ×”×œ ×”×¡× ×™×£</h2>
                <p>×”×‘× ×ª ×”×ª××•× ×” ×”×›×•×œ×œ×ª, ××ª×’×¨×™× ×¢×™×§×¨×™×™× ×•× ×§×•×“×•×ª ×œ×˜×™×¤×•×œ</p>
            </div>

            <div class="question-card" data-field="manager_challenges">
                <div class="question-title">
                    <span class="icon">ğŸ¯</span>
                    <span>××ª×’×¨×™× ×•×‘×¢×™×•×ª ×¢×™×§×¨×™×•×ª</span>
                </div>
                <div class="guiding-questions">
                    <strong>×©××œ×•×ª ×× ×—×•×ª:</strong>
                    <ul>
                        <li>××”× ×©×œ×•×©×ª ×”××ª×’×¨×™× ×”×’×“×•×œ×™× ×‘×™×•×ª×¨ ×›×¨×’×¢?</li>
                        <li>×”×× ×™×© ×‘×¢×™×•×ª ×©×—×•×–×¨×•×ª ×¢×œ ×¢×¦××Ÿ ×•×œ× × ×¤×ª×¨×•×ª?</li>
                        <li>××” ××•× ×¢ ×××š ×œ×ª×¤×§×“ ×‘×¦×•×¨×” ××™×˜×‘×™×ª?</li>
                        <li>×”×× ×§×™×‘×œ×ª ×ª××™×›×” ××¡×¤×§×ª ××”××˜×”?</li>
                    </ul>
                </div>
                <textarea placeholder="×ª×¢×“ ××ª ×”××ª×’×¨×™× ×•×”×‘×¢×™×•×ª ×©×¢×œ×• ×‘×©×™×—×”..." oninput="updateCardStatus(this)"></textarea>
                <div class="media-upload">
                    <div class="upload-zone" onclick="this.querySelector('input').click()">
                        <input type="file" accept="image/*,video/*" multiple onchange="handleMediaUpload(this)">
                        <div class="icon">ğŸ“</div>
                        <p>×”×•×¡×£ ×ª××•× ×•×ª ××• ×¡×¨×˜×•× ×™×</p>
                    </div>
                    <div class="media-preview"></div>
                </div>
            </div>

            <div class="question-card" data-field="manager_hr">
                <div class="question-title">
                    <span class="icon">ğŸ‘¥</span>
                    <span>××¦×‘ ×›×•×— ××“×</span>
                </div>
                <div class="guiding-questions">
                    <strong>×©××œ×•×ª ×× ×—×•×ª:</strong>
                    <ul>
                        <li>××” ××¦×‘ ×”×’×™×•×¡? ×”×× ×™×© ××—×¡×•×¨ ×‘× ×”×’×™×?</li>
                        <li>××”×™ ×¨××ª ×©×‘×™×¢×•×ª ×”×¨×¦×•×Ÿ ×©×œ ×”×¢×•×‘×“×™×?</li>
                        <li>×”×× ×™×© ×ª×—×œ×•×¤×” ×’×‘×•×”×”? ××” ×”×¡×™×‘×•×ª?</li>
                        <li>×”×× ×¦×•×•×ª ×”×”× ×”×œ×” ××œ× ×•××™×•××Ÿ?</li>
                    </ul>
                </div>
                <textarea placeholder="×ª×¢×“ ×××¦××™× ×‘× ×•×©× ×›×•×— ××“×..." oninput="updateCardStatus(this)"></textarea>
                <div class="media-upload">
                    <div class="upload-zone" onclick="this.querySelector('input').click()">
                        <input type="file" accept="image/*,video/*" multiple onchange="handleMediaUpload(this)">
                        <div class="icon">ğŸ“</div>
                        <p>×”×•×¡×£ ×ª××•× ×•×ª ××• ×¡×¨×˜×•× ×™×</p>
                    </div>
                    <div class="media-preview"></div>
                </div>
            </div>

            <div class="question-card" data-field="manager_kpi">
                <div class="question-title">
                    <span class="icon">ğŸ“ˆ</span>
                    <span>×‘×™×¦×•×¢×™× ×•×™×¢×“×™×</span>
                </div>
                <div class="guiding-questions">
                    <strong>×©××œ×•×ª ×× ×—×•×ª:</strong>
                    <ul>
                        <li>×”×× ×”×¡× ×™×£ ×¢×•××“ ×‘×™×¢×“×™×? ××™×œ×• ×™×¢×“×™× ×××ª×’×¨×™×?</li>
                        <li>××” ××¦×‘ ××™-×”×‘×™×¦×•×¢ ×•××™-×”×“×™×•×§?</li>
                        <li>×”×× ×™×© ×§×•×•×™× ×‘×¢×™×™×ª×™×™× ×‘××™×•×—×“?</li>
                        <li>××” × ×¢×©×” ×œ×©×™×¤×•×¨ ×”×‘×™×¦×•×¢×™×?</li>
                    </ul>
                </div>
                <textarea placeholder="×ª×¢×“ ××™×“×¢ ×¢×œ ×‘×™×¦×•×¢×™× ×•×™×¢×“×™×..." oninput="updateCardStatus(this)"></textarea>
                <div class="media-upload">
                    <div class="upload-zone" onclick="this.querySelector('input').click()">
                        <input type="file" accept="image/*,video/*" multiple onchange="handleMediaUpload(this)">
                        <div class="icon">ğŸ“</div>
                        <p>×”×•×¡×£ ×ª××•× ×•×ª ××• ×¡×¨×˜×•× ×™×</p>
                    </div>
                    <div class="media-preview"></div>
                </div>
            </div>
        </div>

        <!-- Section: ×¡×“×¨× ×™×/×©×‘×¥ -->
        <div class="section" id="section-dispatchers">
            <div class="section-header">
                <h2>ğŸ‘· ×©×™×—×” ×¢× ×¡×“×¨× ×™× ×•×©×‘×¥</h2>
                <p>×”×‘× ×ª ×”××ª×’×¨×™× ×”×ª×¤×¢×•×œ×™×™× ×”×™×•××™×•××™×™×</p>
            </div>

            <div class="question-card" data-field="dispatch_daily">
                <div class="question-title">
                    <span class="icon">ğŸ“…</span>
                    <span>××ª×’×¨×™× ×™×•××™×•××™×™×</span>
                </div>
                <div class="guiding-questions">
                    <strong>×©××œ×•×ª ×× ×—×•×ª:</strong>
                    <ul>
                        <li>××” ×”×“×‘×¨ ×”×›×™ ××ª×¡×›×œ ×‘×¢×‘×•×“×” ×”×™×•××™×•××™×ª?</li>
                        <li>×”×× ×™×© ×‘×¢×™×•×ª ×—×•×–×¨×•×ª ×‘×©×™×‘×•×¥?</li>
                        <li>××™×š ××ª××•×“×“×™× ×¢× ×”×™×¢×“×¨×•×™×•×ª ×¤×ª××•××™×•×ª?</li>
                        <li>×”×× ×”××¢×¨×›×•×ª ×ª×•××›×•×ª ×‘×¢×‘×•×“×” ××• ××›×‘×™×“×•×ª?</li>
                    </ul>
                </div>
                <textarea placeholder="×ª×¢×“ ××ª×’×¨×™× ×™×•××™×•××™×™× ×©×œ ×”×¡×“×¨× ×™×..." oninput="updateCardStatus(this)"></textarea>
                <div class="media-upload">
                    <div class="upload-zone" onclick="this.querySelector('input').click()">
                        <input type="file" accept="image/*,video/*" multiple onchange="handleMediaUpload(this)">
                        <div class="icon">ğŸ“</div>
                        <p>×”×•×¡×£ ×ª××•× ×•×ª ××• ×¡×¨×˜×•× ×™×</p>
                    </div>
                    <div class="media-preview"></div>
                </div>
            </div>

            <div class="question-card" data-field="dispatch_communication">
                <div class="question-title">
                    <span class="icon">ğŸ“</span>
                    <span>×ª×§×©×•×¨×ª ×•×××©×§×™×</span>
                </div>
                <div class="guiding-questions">
                    <strong>×©××œ×•×ª ×× ×—×•×ª:</strong>
                    <ul>
                        <li>××™×š ×”×ª×§×©×•×¨×ª ×¢× ×—×“×¨ ×”×‘×§×¨×”?</li>
                        <li>×”×× ××§×‘×œ×™× ××™×“×¢ ×‘×–××Ÿ ×××ª?</li>
                        <li>××™×š ××ª×•×××™× ×©×™× ×•×™×™× ×‘×¨×’×¢ ×”××—×¨×•×Ÿ?</li>
                        <li>×”×× ×™×© ×’×•×¨××™× ×©×§×©×” ×œ×ª×§×©×¨ ××™×ª×?</li>
                    </ul>
                </div>
                <textarea placeholder="×ª×¢×“ ×××¦××™× ×‘× ×•×©× ×ª×§×©×•×¨×ª..." oninput="updateCardStatus(this)"></textarea>
                <div class="media-upload">
                    <div class="upload-zone" onclick="this.querySelector('input').click()">
                        <input type="file" accept="image/*,video/*" multiple onchange="handleMediaUpload(this)">
                        <div class="icon">ğŸ“</div>
                        <p>×”×•×¡×£ ×ª××•× ×•×ª ××• ×¡×¨×˜×•× ×™×</p>
                    </div>
                    <div class="media-preview"></div>
                </div>
            </div>

            <div class="question-card" data-field="dispatch_tools">
                <div class="question-title">
                    <span class="icon">ğŸ› ï¸</span>
                    <span>×›×œ×™× ×•××©××‘×™×</span>
                </div>
                <div class="guiding-questions">
                    <strong>×©××œ×•×ª ×× ×—×•×ª:</strong>
                    <ul>
                        <li>×”×× ×™×© ××¡×¤×™×§ ×›×œ×™× ×œ×¢×‘×•×“×” ×™×¢×™×œ×”?</li>
                        <li>××” ×—×¡×¨ ×›×“×™ ×œ×¢×‘×•×“ ×˜×•×‘ ×™×•×ª×¨?</li>
                        <li>×”×× ×”×”×›×©×¨×” ×©×§×™×‘×œ×ª× ××¡×¤×§×ª?</li>
                        <li>×”×× ×™×© × ×”×œ×™× ×‘×¨×•×¨×™× ×œ×›×œ ××¦×‘?</li>
                    </ul>
                </div>
                <textarea placeholder="×ª×¢×“ ×¦×¨×›×™× ×‘×›×œ×™× ×•××©××‘×™×..." oninput="updateCardStatus(this)"></textarea>
                <div class="media-upload">
                    <div class="upload-zone" onclick="this.querySelector('input').click()">
                        <input type="file" accept="image/*,video/*" multiple onchange="handleMediaUpload(this)">
                        <div class="icon">ğŸ“</div>
                        <p>×”×•×¡×£ ×ª××•× ×•×ª ××• ×¡×¨×˜×•× ×™×</p>
                    </div>
                    <div class="media-preview"></div>
                </div>
            </div>
        </div>

        <!-- Section: × ×”×’×™× -->
        <div class="section" id="section-drivers">
            <div class="section-header">
                <h2>ğŸšŒ ×©×™×—×” ×¢× × ×”×’×™×</h2>
                <p>×”×§×©×‘×” ×œ× ×”×’×™× ×‘×©×˜×— - ×”×œ×‘ ×©×œ ×”×©×™×¨×•×ª</p>
            </div>

            <div class="question-card" data-field="drivers_satisfaction">
                <div class="question-title">
                    <span class="icon">ğŸ˜Š</span>
                    <span>×©×‘×™×¢×•×ª ×¨×¦×•×Ÿ ×•×ª× ××™×</span>
                </div>
                <div class="guiding-questions">
                    <strong>×©××œ×•×ª ×× ×—×•×ª:</strong>
                    <ul>
                        <li>××™×š ××ª×” ××¨×’×™×© ×‘×¡× ×™×£? ××¨×•×¦×”?</li>
                        <li>××™×š ×”×™×—×¡ ×©×œ ×”×”× ×”×œ×” ××œ×™×›×?</li>
                        <li>×”×× ×”×ª× ××™× ×”×•×œ××™× (×—×“×¨ ××•×›×œ, ×©×™×¨×•×ª×™×)?</li>
                        <li>×”×× ××§×©×™×‘×™× ×œ×›× ×›×©×™×© ×‘×¢×™×•×ª?</li>
                    </ul>
                </div>
                <textarea placeholder="×ª×¢×“ ×ª×—×•×©×•×ª ×•×©×‘×™×¢×•×ª ×¨×¦×•×Ÿ ×©×œ × ×”×’×™×..." oninput="updateCardStatus(this)"></textarea>
                <div class="media-upload">
                    <div class="upload-zone" onclick="this.querySelector('input').click()">
                        <input type="file" accept="image/*,video/*" multiple onchange="handleMediaUpload(this)">
                        <div class="icon">ğŸ“</div>
                        <p>×”×•×¡×£ ×ª××•× ×•×ª ××• ×¡×¨×˜×•× ×™×</p>
                    </div>
                    <div class="media-preview"></div>
                </div>
            </div>

            <div class="question-card" data-field="drivers_routes">
                <div class="question-title">
                    <span class="icon">ğŸ›£ï¸</span>
                    <span>×§×•×•×™× ×•×¡×™×“×•×¨×™ ×¢×‘×•×“×”</span>
                </div>
                <div class="guiding-questions">
                    <strong>×©××œ×•×ª ×× ×—×•×ª:</strong>
                    <ul>
                        <li>×”×× ×”×–×× ×™× ×‘×¡×™×“×•×¨ ×¨×™××œ×™×™×?</li>
                        <li>×”×× ×™×© ×§×•×•×™× ×‘×¢×™×™×ª×™×™× ×‘××™×•×—×“?</li>
                        <li>××” ×“×¢×ª×š ×¢×œ ×”×”×¤×¡×§×•×ª ×•×”×× ×•×—×•×ª?</li>
                        <li>×”×× ×™×© ×‘×¢×™×•×ª ×‘×ª×—× ×•×ª ××• ×‘××¡×œ×•×œ×™×?</li>
                    </ul>
                </div>
                <textarea placeholder="×ª×¢×“ ××©×•×‘ ×¢×œ ×§×•×•×™× ×•×¡×™×“×•×¨×™×..." oninput="updateCardStatus(this)"></textarea>
                <div class="media-upload">
                    <div class="upload-zone" onclick="this.querySelector('input').click()">
                        <input type="file" accept="image/*,video/*" multiple onchange="handleMediaUpload(this)">
                        <div class="icon">ğŸ“</div>
                        <p>×”×•×¡×£ ×ª××•× ×•×ª ××• ×¡×¨×˜×•× ×™×</p>
                    </div>
                    <div class="media-preview"></div>
                </div>
            </div>

            <div class="question-card" data-field="drivers_vehicles">
                <div class="question-title">
                    <span class="icon">ğŸš</span>
                    <span>×¨×›×‘×™× ×•×¦×™×•×“</span>
                </div>
                <div class="guiding-questions">
                    <strong>×©××œ×•×ª ×× ×—×•×ª:</strong>
                    <ul>
                        <li>××” ××¦×‘ ×”××•×˜×•×‘×•×¡×™×? ×ª×—×–×•×§×”?</li>
                        <li>×”×× ×™×© ×‘×¢×™×•×ª ×—×•×–×¨×•×ª ×‘×¨×›×‘×™×?</li>
                        <li>×”×× ×”××™×–×•×’/×—×™××•× ×¢×•×‘×“?</li>
                        <li>×”×× ××’×™×‘×™× ××”×¨ ×œ×ª×§×œ×•×ª?</li>
                    </ul>
                </div>
                <textarea placeholder="×ª×¢×“ ×××¦××™× ×¢×œ ××¦×‘ ×”×¨×›×‘×™×..." oninput="updateCardStatus(this)"></textarea>
                <div class="media-upload">
                    <div class="upload-zone" onclick="this.querySelector('input').click()">
                        <input type="file" accept="image/*,video/*" multiple onchange="handleMediaUpload(this)">
                        <div class="icon">ğŸ“</div>
                        <p>×”×•×¡×£ ×ª××•× ×•×ª ××• ×¡×¨×˜×•× ×™×</p>
                    </div>
                    <div class="media-preview"></div>
                </div>
            </div>

            <div class="question-card" data-field="drivers_compensation">
                <div class="question-title">
                    <span class="icon">ğŸ’°</span>
                    <span>×©×›×¨ ×•×”×˜×‘×•×ª</span>
                </div>
                <div class="guiding-questions">
                    <strong>×©××œ×•×ª ×× ×—×•×ª:</strong>
                    <ul>
                        <li>×”×× ×™×© ×‘×¢×™×•×ª ×‘×ª×œ×•×©×™ ×”×©×›×¨?</li>
                        <li>××” ×”××¦×‘ ×¢× ×”×—×–×¨×™ × ×¡×™×¢×•×ª/××•× ×™×•×ª?</li>
                        <li>×”×× ×”×ª×¢×¨×™×¤×™× ×”×•×’× ×™×?</li>
                        <li>×”×× ×™×© ×¢×™×›×•×‘×™× ×‘×ª×©×œ×•××™×?</li>
                    </ul>
                </div>
                <textarea placeholder="×ª×¢×“ × ×•×©××™ ×©×›×¨ ×•×”×˜×‘×•×ª ×©×¢×œ×•..." oninput="updateCardStatus(this)"></textarea>
                <div class="media-upload">
                    <div class="upload-zone" onclick="this.querySelector('input').click()">
                        <input type="file" accept="image/*,video/*" multiple onchange="handleMediaUpload(this)">
                        <div class="icon">ğŸ“</div>
                        <p>×”×•×¡×£ ×ª××•× ×•×ª ××• ×¡×¨×˜×•× ×™×</p>
                    </div>
                    <div class="media-preview"></div>
                </div>
            </div>
        </div>

        <!-- Section: ×—× ×™×•×Ÿ -->
        <div class="section" id="section-parking">
            <div class="section-header">
                <h2>ğŸ…¿ï¸ ×¡×™×•×¨ ×‘×—× ×™×•×Ÿ</h2>
                <p>×‘×—×™× ×ª ××¦×‘ ×ª×—×–×•×§×”, ×‘×˜×™×—×•×ª ×•× ×™×§×™×•×Ÿ</p>
            </div>

            <div class="question-card" data-field="parking_safety">
                <div class="question-title">
                    <span class="icon">âš ï¸</span>
                    <span>×‘×˜×™×—×•×ª</span>
                </div>
                <div class="guiding-questions">
                    <strong>× ×§×•×“×•×ª ×œ×‘×“×™×§×”:</strong>
                    <ul>
                        <li>×”×× ×™×© ×¡×™××•×Ÿ ×‘×¨×•×¨ ×©×œ ××¢×‘×¨×™× ×•× ×ª×™×‘×™×?</li>
                        <li>××¦×‘ ×”×ª××•×¨×” - ×”×× ××¡×¤×™×§×”?</li>
                        <li>×”×× ×™×© ××¤×’×¢×™× ×‘×˜×™×—×•×ª×™×™× (×‘×•×¨×•×ª, ××›×©×•×œ×™×)?</li>
                        <li>×”×× ×¦×™×•×“ ×”×‘×˜×™×—×•×ª ×ª×§×™×Ÿ (××˜×¤×™×, ×©×™×œ×•×˜)?</li>
                        <li>×”×× ×™×© ×’×™×“×•×¨ ×ª×§×™×Ÿ?</li>
                    </ul>
                </div>
                <textarea placeholder="×ª×¢×“ ×××¦××™ ×‘×˜×™×—×•×ª ×‘×—× ×™×•×Ÿ..." oninput="updateCardStatus(this)"></textarea>
                <div class="media-upload">
                    <div class="upload-zone" onclick="this.querySelector('input').click()">
                        <input type="file" accept="image/*,video/*" multiple onchange="handleMediaUpload(this)">
                        <div class="icon">ğŸ“</div>
                        <p>×”×•×¡×£ ×ª××•× ×•×ª ××• ×¡×¨×˜×•× ×™× - ×—×©×•×‘ ×œ×ª×¢×“ ×××¦××™×!</p>
                    </div>
                    <div class="media-preview"></div>
                </div>
            </div>

            <div class="question-card" data-field="parking_maintenance">
                <div class="question-title">
                    <span class="icon">ğŸ”§</span>
                    <span>×ª×—×–×•×§×” ×›×œ×œ×™×ª</span>
                </div>
                <div class="guiding-questions">
                    <strong>× ×§×•×“×•×ª ×œ×‘×“×™×§×”:</strong>
                    <ul>
                        <li>××¦×‘ ×”×¨×™×¦×•×£ ×•×”××¡×¤×œ×˜</li>
                        <li>× ×™×§×•×– - ×”×× ×™×© ×”×¦×¤×•×ª?</li>
                        <li>××¦×‘ ×”×’×“×¨×•×ª ×•×”×©×¢×¨×™×</li>
                        <li>×ª×—×–×•×§×ª ××‘× ×™× ×•××—×¡× ×™×</li>
                        <li>××¦×‘ ×ª×—× ×•×ª ×”×“×œ×§ (×× ×§×™×™××•×ª)</li>
                    </ul>
                </div>
                <textarea placeholder="×ª×¢×“ ××¦×‘ ×ª×—×–×•×§×” ×›×œ×œ×™..." oninput="updateCardStatus(this)"></textarea>
                <div class="media-upload">
                    <div class="upload-zone" onclick="this.querySelector('input').click()">
                        <input type="file" accept="image/*,video/*" multiple onchange="handleMediaUpload(this)">
                        <div class="icon">ğŸ“</div>
                        <p>×”×•×¡×£ ×ª××•× ×•×ª ××• ×¡×¨×˜×•× ×™×</p>
                    </div>
                    <div class="media-preview"></div>
                </div>
            </div>

            <div class="question-card" data-field="parking_cleanliness">
                <div class="question-title">
                    <span class="icon">ğŸ§¹</span>
                    <span>× ×™×§×™×•×Ÿ ×•×¡×“×¨</span>
                </div>
                <div class="guiding-questions">
                    <strong>× ×§×•×“×•×ª ×œ×‘×“×™×§×”:</strong>
                    <ul>
                        <li>× ×™×§×™×•×Ÿ ×›×œ×œ×™ ×©×œ ×”×—× ×™×•×Ÿ</li>
                        <li>××¦×‘ ×¤×—×™ ×”××©×¤×”</li>
                        <li>×¡×“×¨ ×‘×—× ×™×™×ª ×”×¨×›×‘×™×</li>
                        <li>× ×™×§×™×•×Ÿ ×—×“×¨×™ ×”× ×”×’×™× ×•×”×©×™×¨×•×ª×™×</li>
                        <li>×”×× ×™×© ×¤×¡×•×œ×ª ××• ×¦×™×•×“ ××™×•×ª×¨?</li>
                    </ul>
                </div>
                <textarea placeholder="×ª×¢×“ ××¦×‘ × ×™×§×™×•×Ÿ ×•×¡×“×¨..." oninput="updateCardStatus(this)"></textarea>
                <div class="media-upload">
                    <div class="upload-zone" onclick="this.querySelector('input').click()">
                        <input type="file" accept="image/*,video/*" multiple onchange="handleMediaUpload(this)">
                        <div class="icon">ğŸ“</div>
                        <p>×”×•×¡×£ ×ª××•× ×•×ª ××• ×¡×¨×˜×•× ×™×</p>
                    </div>
                    <div class="media-preview"></div>
                </div>
            </div>

            <div class="question-card" data-field="parking_fuel">
                <div class="question-title">
                    <span class="icon">â›½</span>
                    <span>×“×œ×§ ×•×× ×¨×’×™×”</span>
                </div>
                <div class="guiding-questions">
                    <strong>× ×§×•×“×•×ª ×œ×‘×“×™×§×”:</strong>
                    <ul>
                        <li>×”×× ×™×© ×—×©×“ ×œ×’× ×™×‘×ª/×©××™×‘×ª ×“×œ×§?</li>
                        <li>××¦×‘ ×ª×—× ×ª ×”×ª×“×œ×•×§</li>
                        <li>×”×× ×™×© ×‘×§×¨×” ×¢×œ ×¦×¨×™×›×ª ×”×“×œ×§?</li>
                        <li>××¦×‘ ×¢××“×•×ª ×˜×¢×™× ×” (×× ×§×™×™××•×ª)</li>
                    </ul>
                </div>
                <textarea placeholder="×ª×¢×“ ×××¦××™× ×‘× ×•×©× ×“×œ×§ ×•×× ×¨×’×™×”..." oninput="updateCardStatus(this)"></textarea>
                <div class="media-upload">
                    <div class="upload-zone" onclick="this.querySelector('input').click()">
                        <input type="file" accept="image/*,video/*" multiple onchange="handleMediaUpload(this)">
                        <div class="icon">ğŸ“</div>
                        <p>×”×•×¡×£ ×ª××•× ×•×ª ××• ×¡×¨×˜×•× ×™×</p>
                    </div>
                    <div class="media-preview"></div>
                </div>
            </div>
        </div>

        <!-- Section: ××•× ×™×•×ª -->
        <div class="section" id="section-taxis">
            <div class="section-header">
                <h2>ğŸš ××•× ×™×•×ª ×•×”×¡×¢×•×ª × ×”×’×™×</h2>
                <p>××¢×¨×š ×”×”×¡×¢×•×ª ×œ× ×”×’×™× - ×™×¢×™×œ×•×ª ×•×©×‘×™×¢×•×ª ×¨×¦×•×Ÿ</p>
            </div>

            <div class="question-card" data-field="taxis_service">
                <div class="question-title">
                    <span class="icon">ğŸš•</span>
                    <span>××™×›×•×ª ×”×©×™×¨×•×ª</span>
                </div>
                <div class="guiding-questions">
                    <strong>×©××œ×•×ª ×× ×—×•×ª:</strong>
                    <ul>
                        <li>××™×š ×”×™×—×¡ ×©×œ ×¨×›×–×™ ×”××•× ×™×•×ª ×œ× ×”×’×™×?</li>
                        <li>×”×× ×™×© ×ª×œ×•× ×•×ª ×¢×œ ×”×©×™×¨×•×ª?</li>
                        <li>×”×× ×”××•× ×™×•×ª ××’×™×¢×•×ª ×‘×–××Ÿ?</li>
                        <li>×”×× ×™×© ××¡×¤×™×§ ××•× ×™×•×ª ×‘×©×¢×•×ª ×”×©×™×?</li>
                    </ul>
                </div>
                <textarea placeholder="×ª×¢×“ ×××¦××™× ×¢×œ ×©×™×¨×•×ª ×”××•× ×™×•×ª..." oninput="updateCardStatus(this)"></textarea>
                <div class="media-upload">
                    <div class="upload-zone" onclick="this.querySelector('input').click()">
                        <input type="file" accept="image/*,video/*" multiple onchange="handleMediaUpload(this)">
                        <div class="icon">ğŸ“</div>
                        <p>×”×•×¡×£ ×ª××•× ×•×ª ××• ×¡×¨×˜×•× ×™×</p>
                    </div>
                    <div class="media-preview"></div>
                </div>
            </div>

            <div class="question-card" data-field="taxis_local">
                <div class="question-title">
                    <span class="icon">ğŸ </span>
                    <span>× ×”×’×™× ××§×•××™×™× ×•×”×—×–×¨×™ × ×¡×™×¢×•×ª</span>
                </div>
                <div class="guiding-questions">
                    <strong>×©××œ×•×ª ×× ×—×•×ª:</strong>
                    <ul>
                        <li>××” ×”××¦×‘ ×¢× ×”×—×–×¨×™ × ×¡×™×¢×•×ª ×œ× ×”×’×™× ××§×•××™×™×?</li>
                        <li>×”×× ×”×ª×¢×¨×™×¤×™× ×œ×§"× ×”×•×’× ×™×?</li>
                        <li>×”×× ×™×© × ×”×’×™× ×©××¢×“×™×¤×™× ×œ× ×œ×”×©×ª××© ×‘××•× ×™×•×ª?</li>
                        <li>×”×× ×–×” ××©×¤×™×¢ ×¢×œ ×”×’×™×•×¡?</li>
                    </ul>
                </div>
                <textarea placeholder="×ª×¢×“ × ×•×©××™ × ×”×’×™× ××§×•××™×™× ×•×”×—×–×¨×™×..." oninput="updateCardStatus(this)"></textarea>
                <div class="media-upload">
                    <div class="upload-zone" onclick="this.querySelector('input').click()">
                        <input type="file" accept="image/*,video/*" multiple onchange="handleMediaUpload(this)">
                        <div class="icon">ğŸ“</div>
                        <p>×”×•×¡×£ ×ª××•× ×•×ª ××• ×¡×¨×˜×•× ×™×</p>
                    </div>
                    <div class="media-preview"></div>
                </div>
            </div>

            <div class="question-card" data-field="taxis_fairness">
                <div class="question-title">
                    <span class="icon">âš–ï¸</span>
                    <span>×”×•×’× ×•×ª ×•××—×™×“×•×ª</span>
                </div>
                <div class="guiding-questions">
                    <strong>×©××œ×•×ª ×× ×—×•×ª:</strong>
                    <ul>
                        <li>×”×× ×”××ª×•×•×” ××—×™×“ ×œ×›×œ ×”× ×”×’×™×?</li>
                        <li>×”×× ×™×© ×”×‘×“×œ×™× ×œ× ××•×¦×“×§×™×?</li>
                        <li>×”×× ×™×© ×ª×œ×•× ×•×ª ×¢×œ ××¤×œ×™×”?</li>
                        <li>××” ×¦×¨×™×š ×œ×©× ×•×ª ×›×“×™ ×©×™×”×™×” ×”×•×’×Ÿ?</li>
                    </ul>
                </div>
                <textarea placeholder="×ª×¢×“ × ×•×©××™ ×”×•×’× ×•×ª..." oninput="updateCardStatus(this)"></textarea>
                <div class="media-upload">
                    <div class="upload-zone" onclick="this.querySelector('input').click()">
                        <input type="file" accept="image/*,video/*" multiple onchange="handleMediaUpload(this)">
                        <div class="icon">ğŸ“</div>
                        <p>×”×•×¡×£ ×ª××•× ×•×ª ××• ×¡×¨×˜×•× ×™×</p>
                    </div>
                    <div class="media-preview"></div>
                </div>
            </div>
        </div>

        <!-- Section: ×˜×›× ×•×œ×•×’×™×” -->
        <div class="section" id="section-tech">
            <div class="section-header">
                <h2>ğŸ’» ××¢×¨×›×•×ª ×•×˜×›× ×•×œ×•×’×™×”</h2>
                <p>×‘×—×™× ×ª ×”××¢×¨×›×•×ª ×”×“×™×’×™×˜×œ×™×•×ª ×•×—×“×¨ ×”×‘×§×¨×”</p>
            </div>

            <div class="question-card" data-field="tech_control_room">
                <div class="question-title">
                    <span class="icon">ğŸ–¥ï¸</span>
                    <span>×—×“×¨ ×‘×§×¨×”</span>
                </div>
                <div class="guiding-questions">
                    <strong>×©××œ×•×ª ×× ×—×•×ª:</strong>
                    <ul>
                        <li>×”×× ×—×“×¨ ×”×‘×§×¨×” ×¤×¢×™×œ ×‘×›×œ ×©×¢×•×ª ×”×”×¤×¢×œ×”?</li>
                        <li>××” ××™×›×•×ª ×”×× ×©×™× ×‘×—×“×¨ ×”×‘×§×¨×”?</li>
                        <li>×”×× ×™×© ×”×›×©×¨×” ××¡×¤×§×ª?</li>
                        <li>×”×× ×™×© × ×¦×™×’×™× ×™×™×¢×•×“×™×™× ×œ×¡× ×™×£?</li>
                    </ul>
                </div>
                <textarea placeholder="×ª×¢×“ ×××¦××™× ×¢×œ ×—×“×¨ ×”×‘×§×¨×”..." oninput="updateCardStatus(this)"></textarea>
                <div class="media-upload">
                    <div class="upload-zone" onclick="this.querySelector('input').click()">
                        <input type="file" accept="image/*,video/*" multiple onchange="handleMediaUpload(this)">
                        <div class="icon">ğŸ“</div>
                        <p>×”×•×¡×£ ×ª××•× ×•×ª ××• ×¡×¨×˜×•× ×™×</p>
                    </div>
                    <div class="media-preview"></div>
                </div>
            </div>

            <div class="question-card" data-field="tech_systems">
                <div class="question-title">
                    <span class="icon">ğŸ“±</span>
                    <span>××¢×¨×›×•×ª (××•×¤× ×™×™×–, ×× ×”×œ×ª×™×•×ª)</span>
                </div>
                <div class="guiding-questions">
                    <strong>×©××œ×•×ª ×× ×—×•×ª:</strong>
                    <ul>
                        <li>×”×× ×”×’×™×©×” ×œ××¢×¨×›×•×ª ×ª×§×™× ×”?</li>
                        <li>×”×× ×™×© ×‘×¢×™×•×ª ×‘×”×¨×©××•×ª?</li>
                        <li>×”×× ×™×© ×”×ª×¨××•×ª ××™×•×ª×¨×•×ª/×—×¡×¨×•×ª?</li>
                        <li>×”×× ×”××¢×¨×›×•×ª ×¢×•×‘×“×•×ª ×›××¦×•×¤×”?</li>
                    </ul>
                </div>
                <textarea placeholder="×ª×¢×“ ×××¦××™× ×¢×œ ××¢×¨×›×•×ª..." oninput="updateCardStatus(this)"></textarea>
                <div class="media-upload">
                    <div class="upload-zone" onclick="this.querySelector('input').click()">
                        <input type="file" accept="image/*,video/*" multiple onchange="handleMediaUpload(this)">
                        <div class="icon">ğŸ“</div>
                        <p>×”×•×¡×£ ×ª××•× ×•×ª ××• ×¡×¨×˜×•× ×™×</p>
                    </div>
                    <div class="media-preview"></div>
                </div>
            </div>

            <div class="question-card" data-field="tech_communication">
                <div class="question-title">
                    <span class="icon">ğŸ“¡</span>
                    <span>×ª×§×©×•×¨×ª ×•×ª×©×ª×™×•×ª</span>
                </div>
                <div class="guiding-questions">
                    <strong>×©××œ×•×ª ×× ×—×•×ª:</strong>
                    <ul>
                        <li>××¦×‘ ×”××™× ×˜×¨× ×˜ ×•×”×¨×©×ª</li>
                        <li>×”×× ×”××—×©×‘×™× ×ª×§×™× ×™×?</li>
                        <li>××¦×‘ ××¢×¨×›×•×ª ×”×›×¨×™×–×” ×•×”×§×©×¨</li>
                        <li>×”×× ×™×© ×¦×™×•×“ ×—×¡×¨ ××• ×œ× ×ª×§×™×Ÿ?</li>
                    </ul>
                </div>
                <textarea placeholder="×ª×¢×“ ××¦×‘ ×ª×§×©×•×¨×ª ×•×ª×©×ª×™×•×ª..." oninput="updateCardStatus(this)"></textarea>
                <div class="media-upload">
                    <div class="upload-zone" onclick="this.querySelector('input').click()">
                        <input type="file" accept="image/*,video/*" multiple onchange="handleMediaUpload(this)">
                        <div class="icon">ğŸ“</div>
                        <p>×”×•×¡×£ ×ª××•× ×•×ª ××• ×¡×¨×˜×•× ×™×</p>
                    </div>
                    <div class="media-preview"></div>
                </div>
            </div>
        </div>

        <!-- Section: ××•×¡×›×™× -->
        <div class="section" id="section-garage">
            <div class="section-header">
                <h2>ğŸ”§ ××•×¡×›×™× ×•×ª×—×–×•×§×”</h2>
                <p>×‘×—×™× ×ª ×”×××©×§ ×¢× ×”××•×¡×›×™× ×•×ª×”×œ×™×›×™ ×ª×—×–×•×§×”</p>
            </div>

            <div class="question-card" data-field="garage_service">
                <div class="question-title">
                    <span class="icon">ğŸ› ï¸</span>
                    <span>×©×™×¨×•×ª ×”××•×¡×š</span>
                </div>
                <div class="guiding-questions">
                    <strong>×©××œ×•×ª ×× ×—×•×ª:</strong>
                    <ul>
                        <li>××™×š ×”×©×™×¨×•×ª ××”××•×¡×›×™×?</li>
                        <li>×”×× ×–×× ×™ ×”×˜×™×¤×•×œ ×¡×‘×™×¨×™×?</li>
                        <li>×”×× ×™×© ×‘×¢×™×•×ª ×—×•×–×¨×•×ª ×¢× ××•×¡×š ××¡×•×™×?</li>
                        <li>×”×× ×™×© ×§× ×¡×•×ª/×“×•×—×•×ª ×‘×’×œ×œ ×—× ×™×” ×œ×™×“ ×”××•×¡×š?</li>
                    </ul>
                </div>
                <textarea placeholder="×ª×¢×“ ×××¦××™× ×¢×œ ×©×™×¨×•×ª ×”××•×¡×›×™×..." oninput="updateCardStatus(this)"></textarea>
                <div class="media-upload">
                    <div class="upload-zone" onclick="this.querySelector('input').click()">
                        <input type="file" accept="image/*,video/*" multiple onchange="handleMediaUpload(this)">
                        <div class="icon">ğŸ“</div>
                        <p>×”×•×¡×£ ×ª××•× ×•×ª ××• ×¡×¨×˜×•× ×™×</p>
                    </div>
                    <div class="media-preview"></div>
                </div>
            </div>

            <div class="question-card" data-field="garage_process">
                <div class="question-title">
                    <span class="icon">ğŸ“‹</span>
                    <span>×ª×”×œ×™×›×™× ×•× ×”×œ×™×</span>
                </div>
                <div class="guiding-questions">
                    <strong>×©××œ×•×ª ×× ×—×•×ª:</strong>
                    <ul>
                        <li>××™×š ××ª×•×× ×©×œ×™×—×ª ×¨×›×‘ ×œ××•×¡×š?</li>
                        <li>×”×× ×™×© ×‘×¢×™×•×ª ×‘×ª×™××•× ×©×¢×•×ª?</li>
                        <li>××™×š ××˜×¤×œ×™× ×‘×ª×§×œ×•×ª ×“×—×•×¤×•×ª?</li>
                        <li>×”×× ×™×© ×¨×›×‘×™× ×©× ×ª×§×¢×™× ×–××Ÿ ×¨×‘ ×‘××•×¡×š?</li>
                    </ul>
                </div>
                <textarea placeholder="×ª×¢×“ ×‘×¢×™×•×ª ×‘×ª×”×œ×™×›×™×..." oninput="updateCardStatus(this)"></textarea>
                <div class="media-upload">
                    <div class="upload-zone" onclick="this.querySelector('input').click()">
                        <input type="file" accept="image/*,video/*" multiple onchange="handleMediaUpload(this)">
                        <div class="icon">ğŸ“</div>
                        <p>×”×•×¡×£ ×ª××•× ×•×ª ××• ×¡×¨×˜×•× ×™×</p>
                    </div>
                    <div class="media-preview"></div>
                </div>
            </div>
        </div>

        <!-- Section: ×ª×›× ×•×Ÿ -->
        <div class="section" id="section-planning">
            <div class="section-header">
                <h2>ğŸ“Š ×ª×›× ×•×Ÿ ×•×©×™×‘×•×¥</h2>
                <p>×‘×—×™× ×ª ×¡×•×’×™×•×ª ×ª×›× ×•×Ÿ, ×¡×™×“×•×¨×™ ×¢×‘×•×“×” ×•× ×¡×™×¢×•×ª ×¨×™×§×•×ª</p>
            </div>

            <div class="question-card" data-field="planning_schedules">
                <div class="question-title">
                    <span class="icon">ğŸ“…</span>
                    <span>×¡×™×“×•×¨×™ ×¢×‘×•×“×”</span>
                </div>
                <div class="guiding-questions">
                    <strong>×©××œ×•×ª ×× ×—×•×ª:</strong>
                    <ul>
                        <li>×”×× ×™×© ×‘×¢×™×•×ª ×‘×¡×™×“×•×¨×™ ×”×¢×‘×•×“×”?</li>
                        <li>×”×× ×”×©×‘×ª×•×ª × ×¤×ª×—×•×ª × ×›×•×Ÿ?</li>
                        <li>×”×× ×™×© ×§×•×“×™ ×§×‘×•×¦×” ××™×•×ª×¨×™×?</li>
                        <li>×”×× ×”×–×× ×™× ×‘×¡×™×“×•×¨ ×¨×™××œ×™×™×?</li>
                    </ul>
                </div>
                <textarea placeholder="×ª×¢×“ ×‘×¢×™×•×ª ×‘×¡×™×“×•×¨×™ ×¢×‘×•×“×”..." oninput="updateCardStatus(this)"></textarea>
                <div class="media-upload">
                    <div class="upload-zone" onclick="this.querySelector('input').click()">
                        <input type="file" accept="image/*,video/*" multiple onchange="handleMediaUpload(this)">
                        <div class="icon">ğŸ“</div>
                        <p>×”×•×¡×£ ×ª××•× ×•×ª ××• ×¡×¨×˜×•× ×™×</p>
                    </div>
                    <div class="media-preview"></div>
                </div>
            </div>

            <div class="question-card" data-field="planning_deadheads">
                <div class="question-title">
                    <span class="icon">ğŸšŒ</span>
                    <span>× ×¡×™×¢×•×ª ×¨×™×§×•×ª</span>
                </div>
                <div class="guiding-questions">
                    <strong>×©××œ×•×ª ×× ×—×•×ª:</strong>
                    <ul>
                        <li>×”×× ×™×© × ×¡×™×¢×•×ª ×¨×™×§×•×ª ××™×•×ª×¨×•×ª?</li>
                        <li>×”×× ××©×ª××©×™× ×‘×›×œ×™ ×”× ×™×˜×•×¨?</li>
                        <li>×”×× ×™×© ×¨×™×§×•×ª ×©× ×•×¦×¨×•×ª ×‘×’×œ×œ ×ª×›× ×•×Ÿ ×œ×§×•×™?</li>
                        <li>××” ××¤×©×¨ ×œ×©×¤×¨?</li>
                    </ul>
                </div>
                <textarea placeholder="×ª×¢×“ ×××¦××™× ×¢×œ × ×¡×™×¢×•×ª ×¨×™×§×•×ª..." oninput="updateCardStatus(this)"></textarea>
                <div class="media-upload">
                    <div class="upload-zone" onclick="this.querySelector('input').click()">
                        <input type="file" accept="image/*,video/*" multiple onchange="handleMediaUpload(this)">
                        <div class="icon">ğŸ“</div>
                        <p>×”×•×¡×£ ×ª××•× ×•×ª ××• ×¡×¨×˜×•× ×™×</p>
                    </div>
                    <div class="media-preview"></div>
                </div>
            </div>

            <div class="question-card" data-field="planning_rule168">
                <div class="question-title">
                    <span class="icon">â°</span>
                    <span>×ª×§× ×” 168 ×•×”×¤×¡×§×•×ª</span>
                </div>
                <div class="guiding-questions">
                    <strong>×©××œ×•×ª ×× ×—×•×ª:</strong>
                    <ul>
                        <li>×”×× ×™×© ×‘×¢×™×•×ª ×‘×¢××™×“×” ×‘×ª×§× ×” 168?</li>
                        <li>×”×× ×”×”×¤×¡×§×•×ª ××ª×•×›× × ×•×ª × ×›×•×Ÿ?</li>
                        <li>×”×× ×™×© ×¡×™×“×•×¨×™× ×‘×¢×™×™×ª×™×™×?</li>
                        <li>×”×× ×™×© ××§×•××•×ª ×× ×•×—×” ××ª××™××™×?</li>
                    </ul>
                </div>
                <textarea placeholder="×ª×¢×“ ×××¦××™× ×‘× ×•×©× ×ª×§× ×” 168..." oninput="updateCardStatus(this)"></textarea>
                <div class="media-upload">
                    <div class="upload-zone" onclick="this.querySelector('input').click()">
                        <input type="file" accept="image/*,video/*" multiple onchange="handleMediaUpload(this)">
                        <div class="icon">ğŸ“</div>
                        <p>×”×•×¡×£ ×ª××•× ×•×ª ××• ×¡×¨×˜×•× ×™×</p>
                    </div>
                    <div class="media-preview"></div>
                </div>
            </div>
        </div>

        <!-- Section: ×¡×™×›×•× -->
        <div class="section" id="section-summary">
            <div class="section-header">
                <h2>ğŸ“ ×¡×™×›×•× ×”×¡×™×•×¨</h2>
                <p>×¡×™×›×•× ×›×œ×œ×™, ×¤×¢×•×œ×•×ª × ×“×¨×©×•×ª ×•×™×™×¦×•×</p>
            </div>

            <div class="question-card" data-field="summary_general">
                <div class="question-title">
                    <span class="icon">ğŸ“„</span>
                    <span>×¡×™×›×•× ×›×œ×œ×™</span>
                </div>
                <div class="guiding-questions">
                    <strong>× ×§×•×“×•×ª ×œ×¡×™×›×•×:</strong>
                    <ul>
                        <li>××” ×”×¨×•×©× ×”×›×œ×œ×™ ××”×¡× ×™×£?</li>
                        <li>××”×Ÿ 3 ×”× ×§×•×“×•×ª ×”×—×©×•×‘×•×ª ×‘×™×•×ª×¨ ×œ×˜×™×¤×•×œ?</li>
                        <li>×”×× ×™×© ×“×‘×¨×™× ×—×™×•×‘×™×™× ×œ×¦×™×™×Ÿ?</li>
                        <li>×”××œ×¦×•×ª ×œ××¢×§×‘</li>
                    </ul>
                </div>
                <textarea placeholder="×›×ª×•×‘ ×¡×™×›×•× ×›×œ×œ×™ ×©×œ ×”×¡×™×•×¨..." oninput="updateCardStatus(this)" style="min-height: 150px;"></textarea>
            </div>

            <!-- Action Items Section -->
            <div class="action-items-section">
                <div class="action-items-header">
                    <h3>âœ… ×¤×¢×•×œ×•×ª × ×“×¨×©×•×ª</h3>
                    <button class="btn btn-primary" onclick="addActionItem()">
                        <span>â•</span> ×”×•×¡×£ ×¤×¢×•×œ×”
                    </button>
                </div>
                <div id="actionItemsList">
                    <div class="empty-actions">
                        <div class="icon">ğŸ“‹</div>
                        <p>×˜×¨× ×”×•×’×“×¨×• ×¤×¢×•×œ×•×ª × ×“×¨×©×•×ª</p>
                        <p style="font-size: 0.8rem;">×œ×—×¥ "×”×•×¡×£ ×¤×¢×•×œ×”" ×œ×”×’×“×¨×ª ××©×™××” ×—×“×©×”</p>
                    </div>
                </div>
            </div>

            <!-- Summary Stats -->
            <div class="summary-section" id="summaryStats">
                <h3>ğŸ“Š ×¡×˜×˜×™×¡×˜×™×§×•×ª ×”×˜×•×¤×¡</h3>
                <div class="summary-stats">
                    <div class="stat-item">
                        <div class="stat-value" id="statSections">0</div>
                        <div class="stat-label">×§×˜×’×•×¨×™×•×ª ××•×œ××•</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="statFields">0</div>
                        <div class="stat-label">×©×“×•×ª ××•×œ××•</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="statMedia">0</div>
                        <div class="stat-label">×§×‘×¦×™ ××“×™×”</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="statActions">0</div>
                        <div class="stat-label">×¤×¢×•×œ×•×ª × ×“×¨×©×•×ª</div>
                    </div>
                </div>

                <div class="export-buttons">
                    <button class="btn btn-danger" onclick="exportPDF()">
                        <span>ğŸ“•</span> ×™×™×¦× PDF
                    </button>
                    <button class="btn btn-word" onclick="exportWord()">
                        <span>ğŸ“˜</span> ×™×™×¦× Word
                    </button>
                    <button class="btn btn-excel" onclick="exportExcel()">
                        <span>ğŸ“—</span> ×™×™×¦× Excel
                    </button>
                    <button class="btn btn-secondary" onclick="saveLocal()">
                        <span>ğŸ’¾</span> ×©××•×¨ ××§×•××™×ª
                    </button>
                    <button class="btn btn-secondary" onclick="loadLocal()">
                        <span>ğŸ“‚</span> ×˜×¢×Ÿ ×©××•×¨
                    </button>
                </div>
            </div>
        </div>
    </div>

    <div class="toast" id="toast">× ×©××¨ ×‘×”×¦×œ×—×”!</div>

    <footer class="footer">
        <p>×˜×•×¤×¡ ×¡×™×•×¨ ×¡× ×™×£ | ×’×¨×¡×” 2.0</p>
        <p>×”×˜×•×¤×¡ ×¨×¥ ××§×•××™×ª - ×”× ×ª×•× ×™× ×œ× × ×©×œ×—×™× ×œ×©×¨×ª</p>
    </footer>

    <!-- External Libraries for Export -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>

    <script>
        // Initialize
        document.getElementById('visitDate').valueAsDate = new Date();
        
        let actionItemCount = 0;
        let mediaFiles = {};

        // Loading overlay
        function showLoading(text) {
            document.getElementById('loadingText').textContent = text || '××™×™×¦×...';
            document.getElementById('loadingOverlay').classList.add('show');
        }

        function hideLoading() {
            document.getElementById('loadingOverlay').classList.remove('show');
        }

        // Navigation
        document.querySelectorAll('.nav-tab').forEach(tab => {
            tab.addEventListener('click', () => {
                const section = tab.dataset.section;
                
                document.querySelectorAll('.nav-tab').forEach(t => t.classList.remove('active'));
                tab.classList.add('active');
                
                document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
                document.getElementById(`section-${section}`).classList.add('active');
            });
        });

        // Update card status when content is added
        function updateCardStatus(textarea) {
            const card = textarea.closest('.question-card');
            if (textarea.value.trim()) {
                card.classList.add('has-content');
            } else {
                card.classList.remove('has-content');
            }
            updateNavBadges();
            updateStats();
        }

        // Update navigation badges
        function updateNavBadges() {
            document.querySelectorAll('.nav-tab').forEach(tab => {
                const sectionId = tab.dataset.section;
                const section = document.getElementById(`section-${sectionId}`);
                if (!section) return;
                
                const hasContent = section.querySelectorAll('.question-card.has-content').length > 0;
                tab.classList.toggle('has-content', hasContent);
            });
        }

        // Media upload handling
        function handleMediaUpload(input) {
            const preview = input.closest('.media-upload').querySelector('.media-preview');
            const fieldId = input.closest('.question-card').dataset.field;
            
            if (!mediaFiles[fieldId]) mediaFiles[fieldId] = [];
            
            for (const file of input.files) {
                const reader = new FileReader();
                reader.onload = (e) => {
                    const mediaItem = document.createElement('div');
                    mediaItem.className = 'media-item';
                    
                    const isVideo = file.type.startsWith('video');
                    if (isVideo) {
                        mediaItem.innerHTML = `
                            <video src="${e.target.result}"></video>
                            <button class="remove-btn" onclick="removeMedia(this, '${fieldId}', ${mediaFiles[fieldId].length})">âœ•</button>
                        `;
                    } else {
                        mediaItem.innerHTML = `
                            <img src="${e.target.result}" alt="×ª××•× ×”">
                            <button class="remove-btn" onclick="removeMedia(this, '${fieldId}', ${mediaFiles[fieldId].length})">âœ•</button>
                        `;
                    }
                    
                    preview.appendChild(mediaItem);
                    mediaFiles[fieldId].push({
                        name: file.name,
                        type: file.type,
                        data: e.target.result
                    });
                    
                    input.closest('.question-card').classList.add('has-content');
                    updateNavBadges();
                    updateStats();
                };
                reader.readAsDataURL(file);
            }
        }

        function removeMedia(btn, fieldId, index) {
            btn.closest('.media-item').remove();
            if (mediaFiles[fieldId]) {
                mediaFiles[fieldId].splice(index, 1);
            }
            updateStats();
        }

        // Action Items
        function addActionItem() {
            actionItemCount++;
            const list = document.getElementById('actionItemsList');
            
            const emptyState = list.querySelector('.empty-actions');
            if (emptyState) emptyState.remove();
            
            const item = document.createElement('div');
            item.className = 'action-item';
            item.dataset.id = actionItemCount;
            item.innerHTML = `
                <div class="action-item-header">
                    <div class="action-item-number">${actionItemCount}</div>
                    <button class="action-item-remove" onclick="removeActionItem(this)">ğŸ—‘ï¸</button>
                </div>
                <div class="action-item-fields">
                    <div class="field-group full-width">
                        <label>×ª×™××•×¨ ×”×¤×¢×•×œ×”</label>
                        <input type="text" class="action-description" placeholder="××” ×¦×¨×™×š ×œ×¢×©×•×ª?">
                    </div>
                    <div class="field-group">
                        <label>×§×˜×’×•×¨×™×”</label>
                        <select class="action-category">
                            <option value="manager">ğŸ‘” ×× ×”×œ ×¡× ×™×£</option>
                            <option value="dispatchers">ğŸ‘· ×¡×“×¨× ×™×/×©×‘×¥</option>
                            <option value="drivers">ğŸšŒ × ×”×’×™×</option>
                            <option value="parking">ğŸ…¿ï¸ ×—× ×™×•×Ÿ</option>
                            <option value="taxis">ğŸš ××•× ×™×•×ª</option>
                            <option value="tech">ğŸ’» ×˜×›× ×•×œ×•×’×™×”</option>
                            <option value="garage">ğŸ”§ ××•×¡×›×™×</option>
                            <option value="planning">ğŸ“Š ×ª×›× ×•×Ÿ</option>
                        </select>
                    </div>
                    <div class="field-group">
                        <label>××—×¨××™</label>
                        <input type="text" class="action-assignee" placeholder="×©× ×”××—×¨××™">
                    </div>
                    <div class="field-group">
                        <label>×ª××¨×™×š ×™×¢×“</label>
                        <input type="date" class="action-due-date">
                    </div>
                    <div class="field-group">
                        <label>×¢×“×™×¤×•×ª</label>
                        <div class="priority-select">
                            <div class="priority-option" data-priority="high" onclick="setPriority(this)">ğŸ”´ ×’×‘×•×”×”</div>
                            <div class="priority-option selected medium" data-priority="medium" onclick="setPriority(this)">ğŸŸ¡ ×‘×™× ×•× ×™×ª</div>
                            <div class="priority-option" data-priority="low" onclick="setPriority(this)">ğŸŸ¢ × ××•×›×”</div>
                        </div>
                    </div>
                </div>
            `;
            
            list.appendChild(item);
            updateStats();
        }

        function removeActionItem(btn) {
            btn.closest('.action-item').remove();
            
            const items = document.querySelectorAll('.action-item');
            items.forEach((item, index) => {
                item.querySelector('.action-item-number').textContent = index + 1;
            });
            
            if (items.length === 0) {
                document.getElementById('actionItemsList').innerHTML = `
                    <div class="empty-actions">
                        <div class="icon">ğŸ“‹</div>
                        <p>×˜×¨× ×”×•×’×“×¨×• ×¤×¢×•×œ×•×ª × ×“×¨×©×•×ª</p>
                        <p style="font-size: 0.8rem;">×œ×—×¥ "×”×•×¡×£ ×¤×¢×•×œ×”" ×œ×”×’×“×¨×ª ××©×™××” ×—×“×©×”</p>
                    </div>
                `;
            }
            
            updateStats();
        }

        function setPriority(el) {
            const container = el.parentElement;
            container.querySelectorAll('.priority-option').forEach(opt => {
                opt.classList.remove('selected', 'high', 'medium', 'low');
            });
            el.classList.add('selected', el.dataset.priority);
        }

        // Stats
        function updateStats() {
            const sections = document.querySelectorAll('.section:not(#section-summary)');
            let filledSections = 0;
            sections.forEach(section => {
                if (section.querySelectorAll('.question-card.has-content').length > 0) {
                    filledSections++;
                }
            });
            document.getElementById('statSections').textContent = filledSections;
            
            const filledFields = document.querySelectorAll('.question-card.has-content').length;
            document.getElementById('statFields').textContent = filledFields;
            
            let totalMedia = 0;
            for (const field in mediaFiles) {
                totalMedia += mediaFiles[field].length;
            }
            document.getElementById('statMedia').textContent = totalMedia;
            
            const actionItems = document.querySelectorAll('.action-item').length;
            document.getElementById('statActions').textContent = actionItems;
        }

        // Collect form data
        function collectFormData() {
            const data = {
                meta: {
                    branchName: document.getElementById('branchName').value,
                    visitDate: document.getElementById('visitDate').value,
                    visitorName: document.getElementById('visitorName').value,
                    branchManager: document.getElementById('branchManager').value,
                    exportedAt: new Date().toISOString()
                },
                sections: {},
                actionItems: [],
                media: mediaFiles
            };
            
            document.querySelectorAll('.question-card').forEach(card => {
                const fieldId = card.dataset.field;
                const textarea = card.querySelector('textarea');
                if (fieldId && textarea) {
                    data.sections[fieldId] = textarea.value;
                }
            });
            
            document.querySelectorAll('.action-item').forEach(item => {
                const priorityEl = item.querySelector('.priority-option.selected');
                data.actionItems.push({
                    description: item.querySelector('.action-description')?.value || '',
                    category: item.querySelector('.action-category')?.value || '',
                    assignee: item.querySelector('.action-assignee')?.value || '',
                    dueDate: item.querySelector('.action-due-date')?.value || '',
                    priority: priorityEl?.dataset.priority || 'medium'
                });
            });
            
            return data;
        }

        const sectionNames = {
            manager_challenges: 'ğŸ‘” ×× ×”×œ ×¡× ×™×£ - ××ª×’×¨×™× ×•×‘×¢×™×•×ª',
            manager_hr: 'ğŸ‘” ×× ×”×œ ×¡× ×™×£ - ×›×•×— ××“×',
            manager_kpi: 'ğŸ‘” ×× ×”×œ ×¡× ×™×£ - ×‘×™×¦×•×¢×™×',
            dispatch_daily: 'ğŸ‘· ×¡×“×¨× ×™× - ××ª×’×¨×™× ×™×•××™×•××™×™×',
            dispatch_communication: 'ğŸ‘· ×¡×“×¨× ×™× - ×ª×§×©×•×¨×ª',
            dispatch_tools: 'ğŸ‘· ×¡×“×¨× ×™× - ×›×œ×™× ×•××©××‘×™×',
            drivers_satisfaction: 'ğŸšŒ × ×”×’×™× - ×©×‘×™×¢×•×ª ×¨×¦×•×Ÿ',
            drivers_routes: 'ğŸšŒ × ×”×’×™× - ×§×•×•×™× ×•×¡×™×“×•×¨×™×',
            drivers_vehicles: 'ğŸšŒ × ×”×’×™× - ×¨×›×‘×™×',
            drivers_compensation: 'ğŸšŒ × ×”×’×™× - ×©×›×¨ ×•×”×˜×‘×•×ª',
            parking_safety: 'ğŸ…¿ï¸ ×—× ×™×•×Ÿ - ×‘×˜×™×—×•×ª',
            parking_maintenance: 'ğŸ…¿ï¸ ×—× ×™×•×Ÿ - ×ª×—×–×•×§×”',
            parking_cleanliness: 'ğŸ…¿ï¸ ×—× ×™×•×Ÿ - × ×™×§×™×•×Ÿ',
            parking_fuel: 'ğŸ…¿ï¸ ×—× ×™×•×Ÿ - ×“×œ×§',
            taxis_service: 'ğŸš ××•× ×™×•×ª - ××™×›×•×ª ×©×™×¨×•×ª',
            taxis_local: 'ğŸš ××•× ×™×•×ª - × ×”×’×™× ××§×•××™×™×',
            taxis_fairness: 'ğŸš ××•× ×™×•×ª - ×”×•×’× ×•×ª',
            tech_control_room: 'ğŸ’» ×˜×›× ×•×œ×•×’×™×” - ×—×“×¨ ×‘×§×¨×”',
            tech_systems: 'ğŸ’» ×˜×›× ×•×œ×•×’×™×” - ××¢×¨×›×•×ª',
            tech_communication: 'ğŸ’» ×˜×›× ×•×œ×•×’×™×” - ×ª×§×©×•×¨×ª',
            garage_service: 'ğŸ”§ ××•×¡×›×™× - ×©×™×¨×•×ª',
            garage_process: 'ğŸ”§ ××•×¡×›×™× - ×ª×”×œ×™×›×™×',
            planning_schedules: 'ğŸ“Š ×ª×›× ×•×Ÿ - ×¡×™×“×•×¨×™ ×¢×‘×•×“×”',
            planning_deadheads: 'ğŸ“Š ×ª×›× ×•×Ÿ - × ×¡×™×¢×•×ª ×¨×™×§×•×ª',
            planning_rule168: 'ğŸ“Š ×ª×›× ×•×Ÿ - ×ª×§× ×” 168',
            summary_general: 'ğŸ“ ×¡×™×›×•× ×›×œ×œ×™'
        };

        const categoryNames = {
            manager: 'ğŸ‘” ×× ×”×œ ×¡× ×™×£',
            dispatchers: 'ğŸ‘· ×¡×“×¨× ×™×/×©×‘×¥',
            drivers: 'ğŸšŒ × ×”×’×™×',
            parking: 'ğŸ…¿ï¸ ×—× ×™×•×Ÿ',
            taxis: 'ğŸš ××•× ×™×•×ª',
            tech: 'ğŸ’» ×˜×›× ×•×œ×•×’×™×”',
            garage: 'ğŸ”§ ××•×¡×›×™×',
            planning: 'ğŸ“Š ×ª×›× ×•×Ÿ'
        };

        // Export PDF
        function exportPDF() {
            showLoading('××›×™×Ÿ PDF...');
            const content = generateReportHTML();
            
            const opt = {
                margin: [10, 10, 10, 10],
                filename: `×¡×™×•×¨_${document.getElementById('branchName').value || '×¡× ×™×£'}_${document.getElementById('visitDate').value}.pdf`,
                image: { type: 'jpeg', quality: 0.98 },
                html2canvas: { scale: 2, useCORS: true, letterRendering: true },
                jsPDF: { unit: 'mm', format: 'a4', orientation: 'portrait' },
                pagebreak: { mode: 'avoid-all', before: '.page-break' }
            };
            
            const element = document.createElement('div');
            element.innerHTML = content;
            element.style.direction = 'rtl';
            element.style.fontFamily = 'Heebo, Arial, sans-serif';
            document.body.appendChild(element);
            
            html2pdf().set(opt).from(element).save().then(() => {
                document.body.removeChild(element);
                hideLoading();
                showToast('PDF × ×•×¦×¨ ×‘×”×¦×œ×—×”!');
            }).catch(err => {
                document.body.removeChild(element);
                hideLoading();
                showToast('×©×’×™××” ×‘×™×¦×™×¨×ª PDF');
                console.error(err);
            });
        }

        // Export Word
        function exportWord() {
            showLoading('××›×™×Ÿ Word...');
            const content = generateReportHTML();
            
            const html = `
                <html xmlns:o='urn:schemas-microsoft-com:office:office' 
                      xmlns:w='urn:schemas-microsoft-com:office:word' 
                      xmlns='http://www.w3.org/TR/REC-html40'>
                <head>
                    <meta charset="utf-8">
                    <title>×¡×™×•×¨ ×¡× ×™×£</title>
                    <!--[if gte mso 9]>
                    <xml>
                        <w:WordDocument>
                            <w:View>Print</w:View>
                            <w:Zoom>100</w:Zoom>
                            <w:DoNotOptimizeForBrowser/>
                        </w:WordDocument>
                    </xml>
                    <![endif]-->
                    <style>
                        @page { size: A4; margin: 2cm; }
                        body { font-family: 'Arial', sans-serif; direction: rtl; font-size: 12pt; line-height: 1.6; }
                        h1 { font-size: 18pt; color: #1a1a2e; border-bottom: 2px solid #0066ff; padding-bottom: 10pt; }
                        h2 { font-size: 14pt; color: #0066ff; margin-top: 20pt; }
                        h3 { font-size: 12pt; color: #333; margin-top: 15pt; }
                        .meta-table { width: 100%; border-collapse: collapse; margin: 15pt 0; }
                        .meta-table td { padding: 8pt; border: 1px solid #ddd; }
                        .meta-table td:first-child { background: #f5f5f5; font-weight: bold; width: 120pt; }
                        .section { margin: 20pt 0; padding: 15pt; background: #fafafa; border-right: 4px solid #0066ff; }
                        .content { margin: 10pt 0; padding: 10pt; background: white; border: 1px solid #eee; white-space: pre-wrap; }
                        table { width: 100%; border-collapse: collapse; margin: 10pt 0; }
                        th, td { padding: 8pt; border: 1px solid #ddd; text-align: right; }
                        th { background: #f0f0f0; }
                        .priority-high { color: #dc3545; font-weight: bold; }
                        .priority-medium { color: #ffc107; }
                        .priority-low { color: #28a745; }
                    </style>
                </head>
                <body>
                    ${content}
                </body>
                </html>
            `;
            
            const blob = new Blob(['\ufeff' + html], { type: 'application/msword' });
            saveAs(blob, `×¡×™×•×¨_${document.getElementById('branchName').value || '×¡× ×™×£'}_${document.getElementById('visitDate').value}.doc`);
            hideLoading();
            showToast('Word × ×•×¦×¨ ×‘×”×¦×œ×—×”!');
        }

        // Export Excel
        function exportExcel() {
            showLoading('××›×™×Ÿ Excel...');
            const data = collectFormData();
            
            try {
                const wb = XLSX.utils.book_new();
                
                // Sheet 1: ×¤×¨×˜×™ ×”×¡×™×•×¨
                const metaData = [
                    ['ğŸ“‹ ×“×•×— ×¡×™×•×¨ ×¡× ×™×£'],
                    [],
                    ['×©×“×”', '×¢×¨×š'],
                    ['×©× ×”×¡× ×™×£', data.meta.branchName],
                    ['×ª××¨×™×š ×¡×™×•×¨', data.meta.visitDate],
                    ['×©× ×”×¡×™×™×¨', data.meta.visitorName],
                    ['×× ×”×œ ×”×¡× ×™×£', data.meta.branchManager],
                    ['×ª××¨×™×š ×™×¦×™×¨×ª ×”×“×•×—', new Date().toLocaleString('he-IL')]
                ];
                const ws1 = XLSX.utils.aoa_to_sheet(metaData);
                ws1['!cols'] = [{ width: 20 }, { width: 40 }];
                XLSX.utils.book_append_sheet(wb, ws1, '×¤×¨×˜×™ ×¡×™×•×¨');
                
                // Sheet 2: ×××¦××™×
                const findingsData = [['×§×˜×’×•×¨×™×”', '×××¦××™×']];
                for (const [key, value] of Object.entries(data.sections)) {
                    if (value.trim()) {
                        findingsData.push([sectionNames[key] || key, value]);
                    }
                }
                const ws2 = XLSX.utils.aoa_to_sheet(findingsData);
                ws2['!cols'] = [{ width: 30 }, { width: 80 }];
                XLSX.utils.book_append_sheet(wb, ws2, '×××¦××™×');
                
                // Sheet 3: ×¤×¢×•×œ×•×ª × ×“×¨×©×•×ª
                const priorityNames = { high: '×’×‘×•×”×” ğŸ”´', medium: '×‘×™× ×•× ×™×ª ğŸŸ¡', low: '× ××•×›×” ğŸŸ¢' };
                const actionsData = [['#', '×ª×™××•×¨', '×§×˜×’×•×¨×™×”', '××—×¨××™', '×ª××¨×™×š ×™×¢×“', '×¢×“×™×¤×•×ª']];
                data.actionItems.forEach((item, i) => {
                    actionsData.push([
                        i + 1,
                        item.description,
                        categoryNames[item.category] || item.category,
                        item.assignee,
                        item.dueDate,
                        priorityNames[item.priority] || item.priority
                    ]);
                });
                const ws3 = XLSX.utils.aoa_to_sheet(actionsData);
                ws3['!cols'] = [{ width: 5 }, { width: 50 }, { width: 20 }, { width: 15 }, { width: 12 }, { width: 12 }];
                XLSX.utils.book_append_sheet(wb, ws3, '×¤×¢×•×œ×•×ª × ×“×¨×©×•×ª');
                
                XLSX.writeFile(wb, `×¡×™×•×¨_${data.meta.branchName || '×¡× ×™×£'}_${data.meta.visitDate}.xlsx`);
                hideLoading();
                showToast('Excel × ×•×¦×¨ ×‘×”×¦×œ×—×”!');
            } catch (err) {
                hideLoading();
                showToast('×©×’×™××” ×‘×™×¦×™×¨×ª Excel');
                console.error(err);
            }
        }

        function generateReportHTML() {
            const data = collectFormData();
            
            let html = `
                <h1>ğŸ“‹ ×“×•×— ×¡×™×•×¨ ×¡× ×™×£</h1>
                
                <table class="meta-table">
                    <tr><td>×©× ×”×¡× ×™×£</td><td><strong>${data.meta.branchName || '-'}</strong></td></tr>
                    <tr><td>×ª××¨×™×š ×¡×™×•×¨</td><td>${data.meta.visitDate || '-'}</td></tr>
                    <tr><td>×©× ×”×¡×™×™×¨</td><td>${data.meta.visitorName || '-'}</td></tr>
                    <tr><td>×× ×”×œ ×”×¡× ×™×£</td><td>${data.meta.branchManager || '-'}</td></tr>
                </table>
                
                <h2>ğŸ“Š ×××¦××™×</h2>
            `;
            
            const categories = {
                '×× ×”×œ ×¡× ×™×£': ['manager_challenges', 'manager_hr', 'manager_kpi'],
                '×¡×“×¨× ×™×/×©×‘×¥': ['dispatch_daily', 'dispatch_communication', 'dispatch_tools'],
                '× ×”×’×™×': ['drivers_satisfaction', 'drivers_routes', 'drivers_vehicles', 'drivers_compensation'],
                '×—× ×™×•×Ÿ': ['parking_safety', 'parking_maintenance', 'parking_cleanliness', 'parking_fuel'],
                '××•× ×™×•×ª': ['taxis_service', 'taxis_local', 'taxis_fairness'],
                '×˜×›× ×•×œ×•×’×™×”': ['tech_control_room', 'tech_systems', 'tech_communication'],
                '××•×¡×›×™×': ['garage_service', 'garage_process'],
                '×ª×›× ×•×Ÿ': ['planning_schedules', 'planning_deadheads', 'planning_rule168'],
                '×¡×™×›×•×': ['summary_general']
            };
            
            for (const [catName, fields] of Object.entries(categories)) {
                const filledFields = fields.filter(f => data.sections[f]?.trim());
                if (filledFields.length === 0) continue;
                
                html += `<div class="section"><h3>${catName}</h3>`;
                for (const field of filledFields) {
                    html += `
                        <p><strong>${sectionNames[field]}</strong></p>
                        <div class="content">${data.sections[field].replace(/\n/g, '<br>')}</div>
                    `;
                }
                html += `</div>`;
            }
            
            if (data.actionItems.length > 0) {
                html += `
                    <h2>âœ… ×¤×¢×•×œ×•×ª × ×“×¨×©×•×ª</h2>
                    <table>
                        <thead>
                            <tr>
                                <th>#</th>
                                <th>×ª×™××•×¨</th>
                                <th>×§×˜×’×•×¨×™×”</th>
                                <th>××—×¨××™</th>
                                <th>×ª××¨×™×š ×™×¢×“</th>
                                <th>×¢×“×™×¤×•×ª</th>
                            </tr>
                        </thead>
                        <tbody>
                `;
                
                data.actionItems.forEach((item, i) => {
                    const priorityClass = `priority-${item.priority}`;
                    const priorityText = item.priority === 'high' ? 'ğŸ”´ ×’×‘×•×”×”' : 
                                        item.priority === 'medium' ? 'ğŸŸ¡ ×‘×™× ×•× ×™×ª' : 'ğŸŸ¢ × ××•×›×”';
                    html += `
                        <tr>
                            <td>${i + 1}</td>
                            <td>${item.description}</td>
                            <td>${categoryNames[item.category] || item.category}</td>
                            <td>${item.assignee}</td>
                            <td>${item.dueDate}</td>
                            <td class="${priorityClass}">${priorityText}</td>
                        </tr>
                    `;
                });
                
                html += `</tbody></table>`;
            }
            
            html += `
                <p style="margin-top: 30pt; color: #666; font-size: 10pt; text-align: center;">
                    ×“×•×— ×–×” × ×•×¦×¨ ××•×˜×•××˜×™×ª ××˜×•×¤×¡ ×¡×™×•×¨ ×¡× ×™×£ | ${new Date().toLocaleString('he-IL')}
                </p>
            `;
            
            return html;
        }

        function saveLocal() {
            const data = collectFormData();
            localStorage.setItem('branchInspectionForm', JSON.stringify(data));
            showToast('×”×˜×•×¤×¡ × ×©××¨ ××§×•××™×ª!');
        }

        function loadLocal() {
            const saved = localStorage.getItem('branchInspectionForm');
            if (!saved) {
                showToast('×œ× × ××¦× ×˜×•×¤×¡ ×©××•×¨');
                return;
            }
            
            const data = JSON.parse(saved);
            
            document.getElementById('branchName').value = data.meta.branchName || '';
            document.getElementById('visitDate').value = data.meta.visitDate || '';
            document.getElementById('visitorName').value = data.meta.visitorName || '';
            document.getElementById('branchManager').value = data.meta.branchManager || '';
            
            for (const [fieldId, value] of Object.entries(data.sections)) {
                const card = document.querySelector(`[data-field="${fieldId}"]`);
                if (card) {
                    const textarea = card.querySelector('textarea');
                    if (textarea) {
                        textarea.value = value;
                        updateCardStatus(textarea);
                    }
                }
            }
            
            const actionsList = document.getElementById('actionItemsList');
            actionsList.innerHTML = '';
            actionItemCount = 0;
            
            if (data.actionItems && data.actionItems.length > 0) {
                data.actionItems.forEach(item => {
                    addActionItem();
                    const lastItem = actionsList.lastElementChild;
                    lastItem.querySelector('.action-description').value = item.description;
                    lastItem.querySelector('.action-category').value = item.category;
                    lastItem.querySelector('.action-assignee').value = item.assignee;
                    lastItem.querySelector('.action-due-date').value = item.dueDate;
                    
                    const priorityEl = lastItem.querySelector(`[data-priority="${item.priority}"]`);
                    if (priorityEl) setPriority(priorityEl);
                });
            } else {
                actionsList.innerHTML = `
                    <div class="empty-actions">
                        <div class="icon">ğŸ“‹</div>
                        <p>×˜×¨× ×”×•×’×“×¨×• ×¤×¢×•×œ×•×ª × ×“×¨×©×•×ª</p>
                        <p style="font-size: 0.8rem;">×œ×—×¥ "×”×•×¡×£ ×¤×¢×•×œ×”" ×œ×”×’×“×¨×ª ××©×™××” ×—×“×©×”</p>
                    </div>
                `;
            }
            
            mediaFiles = {};
            updateStats();
            showToast('×”×˜×•×¤×¡ × ×˜×¢×Ÿ ×‘×”×¦×œ×—×”!');
        }

        function showToast(message) {
            const toast = document.getElementById('toast');
            toast.textContent = message;
            toast.classList.add('show');
            setTimeout(() => toast.classList.remove('show'), 3000);
        }

        updateStats();
    </script>
</body>
</html>